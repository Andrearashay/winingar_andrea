---
title: "HW09: Wrangling II"
author: "Andrea Winingar"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

Load packages.

```{r}
library(tidyverse)
library(here)
library(knitr)
library(smatr)
```

source functions.

```{r}
my_functions <- source(here('Scripts', 'my_functions.R'))
```

### Darters in Riffles

#### Import Data

This code chunk imports the darter data. Then use filter() to remove tetrazonum and zonale. 

```{r}
import_darter <- read_csv(here('data', 'darters.csv')) %>% 
  filter(species == "blennioides" | species == "caeruleum" | species == "spectabile")
```

#### Wrangle Data

Use mutate() to sum majsub and minsub in new column called total_substrate, change riffle value 1 and 2 to riffle 1 and riffle 2. change length from cm to mm. change sex values from f and m to female and male. 

```{r}
darter_data <- import_darter %>% 
  mutate(sex = ifelse(sex == "f", 
                             "female", 
                             "male"),
         total_substrate = majsub + minsub,
         length = length * 10,
         riffle = ifelse(riffle == "1",
                         "riffle 1",
                         "riffle 2"))
darter_data
```

#### Summarize Data

Summarize data with group_by and summarize. summarize mean length, depth, and velocity for each species for each riffle. 

```{r}
summarized_darter <- group_by(darter_data, riffle, species)
summarized_darter <- summarise(summarized_darter, 
          length = mean(length, na.rm = TRUE), 
          depth = mean(depth, na.rm = TRUE),
          velocity = mean(velocity, na.rm = TRUE))
summarized_darter
```

#### Table results

Use kable() to make table with summary means.

```{r}
summarized_darter %>% 
  kable()
```

#### Graph Data

Plot 1: uses stat_summary() technique x = species, y = length. add geom_point layer to add mean length of each species to the plot with filled square shape.

```{r}
ggplot(data = darter_data) +
  stat_summary(
    mapping = aes(x = species, y = length)
  ) +
  coord_flip() +
  facet_wrap(~ riffle) +
  labs( x = NULL, y = 'Length (mm)') +
  geom_point(data = summarized_darter, mapping = aes(x = species, y = length), shape = 15)
```

Plot 2: New plot with new geom_point layer of the length variable for each species. Change point color to gray60. add stat_summary() layer with arguments fun.y = median, geom = 'point', and size = 2.2. Add another stat_summary() change y function to mean, size to 3, and add color = 'maroon'. facet, flip and label. 

```{r}
darter_data %>% 
  ggplot() +
  geom_point(mapping = aes(x = species, y = length), color = 'gray60') +
  stat_summary(
    mapping = aes(x = species, y = length),
    fun.y = median,
    geom = 'point',
    size = 2.2
  ) +
  stat_summary(
    mapping = aes(x = species, y = length),
    fun.y = mean,
    size = 3,
    color = "maroon"
  ) +
  facet_wrap(~ riffle) +
  coord_flip() +
  labs(x = NULL, y = 'Length (mm)')
```


### Stress and Corticosterones in birds

#### Import data

This code chunk imports data.

```{r}
import_feathers <- read.csv(here('data', 'feathers.csv'))
```









